semantic_models:
- name: daily_sales_summary
  description: Aggregated daily sales summary by region.
  model: ref('daily_sales_summary')
  defaults:
    agg_time_dimension: date
  entities:
  - name: sale
    type: primary
    expr: sale_id
  dimensions:
  - name: date
    expr: sale_date
    type: time
    type_params:
      time_granularity: day
  - name: region
    type: categorical
  measures:
  - name: total_sales
    description: The total number of distinct sales.
    agg: count_distinct
    create_metric: true
  - name: revenue
    description: The total revenue from sales.
    agg: sum
    create_metric: true
  - name: avg_quantity_per_sale
    description: The average quantity per sale.
    agg: average
    create_metric: true
  - name: count_sale
    agg: count
    create_metric: true
    expr: sale_id

metrics:
- name: monthly_sales
  description: Monthly sales calculated from daily sales summary.
  label: Monthly Sales
  type: cumulative
  type_params:
    grain_to_date: month
    measure:
      name: total_sales

